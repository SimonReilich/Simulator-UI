<div class="container">
    <h2>Population Protocols</h2>

    <mat-divider></mat-divider>

    <mat-form-field>
        <mat-label>Wähle ein Protokoll aus</mat-label>
        <mat-select [(value)]="selected">
            <mat-option value="maj">Majority</mat-option>
            <mat-option value="pbl">Pebble</mat-option>
            <mat-option value="min">Min</mat-option>
            <mat-option value="mod">Mod</mat-option>
            <mat-option value="min-mod">Min-Mod</mat-option>
            <mat-option value="monadic">Monadic</mat-option>
        </mat-select>
    </mat-form-field>

    <mat-divider></mat-divider>

    @switch (selected) {
    @case ("maj") {
        <maj-controls (agents1Changed)="handleAgents1Change($event)" (agents2Changed)="handleAgents2Change($event)"></maj-controls>
    }
    @case ("pbl") {
        <pbl-controls (agentsChanged)="handleAgentsChange($event)" (maxChanged)="handleMaxChange($event)"></pbl-controls>
    }
    @case ("min") {
        <min-controls (agentsChanged)="handleAgentsChange($event)" (maxChanged)="handleMaxChange($event)"></min-controls>
    }
    @case ("mod") {
        <mod-controls (agentsChanged)="handleAgentsChange($event)" (modChanged)="handleModChange($event)"></mod-controls>
    }
    @case ("min-mod") {
        <cmb-controls (agentsChanged)="handleAgentsChange($event)" (maxChanged)="handleMaxChange($event)" (modChanged)="handleModChange($event)"></cmb-controls>
    }
    @case ("monadic") {
        <mdc-controls (agents1Changed)="handleAgents1Change($event)" (max1Changed)="handleMax1Change($event)" (mod1Changed)="handleMod1Change($event)" (agents2Changed)="handleAgents2Change($event)" (max2Changed)="handleMax2Change($event)" (mod2Changed)="handleMod2Change($event)"></mdc-controls>
    }
    @default {
    <p>Fehler</p>
    }
    }

    <mat-divider></mat-divider>

    <h2>Einstellungen:</h2>

    <mat-divider></mat-divider>

    <div class="randomContainer">
        <span>
            Zufälliger Sniper
        </span>

        <mat-slide-toggle 
            [(ngModel)]="isRandomSniper" 
            (ngModelChange)="updateMap('randomSniper', isRandomSniper)">
        </mat-slide-toggle>
    </div>

    @if (isRandomSniper) {
        <p>Wahrscheinlichkeit p:</p>
        <mat-slider min="0" max="1" step="0.1">
        <input matSliderThumb (valueChange)="onProbChange($event)">
        </mat-slider>
    }

    <mat-form-field class="seedField">
        <mat-label>Seed (optional)</mat-label>
        <input 
            matInput 
            type="number" 
            [(ngModel)]="seedValue" 
            (ngModelChange)="updateMap('seed', seedValue)"
            placeholder="0">
    </mat-form-field>
</div>

<div class="container-bottom">
    <button 
        class="start" 
        [disabled]="isRunning" 
        (click)="onStart()">
        <mat-icon fontIcon="play_arrow"></mat-icon>
    </button>
    
    <button 
        class="quit" 
        [disabled]="!isRunning" 
        (click)="onQuit()">
        <mat-icon fontIcon="stop_circle"></mat-icon>
    </button>
</div>